\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{amsmath}

%SetFonts

%SetFonts


\title{Damping in the Winter's Model}
\author{Jeffrey J. Early}
%\date{}							% Activate to display a given date or no date

\begin{document}
\maketitle
%\section{}
%\subsection{}
Using the terminology of Kraig Winters we need to define a reasonable coefficient for damping.

Given that,
\begin{equation}
\frac{\partial u}{\partial t} = \nu \nabla^{2n} u
\end{equation}
is spectrally,
\begin{equation}
\frac{\partial u}{\partial t} = \nu (i k 2 \pi)^{2n} u
\end{equation}
which has the solution
\begin{equation}
u = e^{\nu (i k 2 \pi)^{2n} t}.
\end{equation}
We want to convert this into an e-fold time, so we want
\begin{equation}
e^{-t/T}=e^{\nu (i k 2 \pi)^{2n} t}.
\end{equation}
Using that $k=\frac{1}{2\Delta}$ where $\Delta$ is the sample interval and solving for $\nu$ in terms of the other variables,
\begin{equation}
\nu = \frac{(-1)^{n+1}}{T} \left( \frac{\Delta}{\pi} \right)^{2n}
\end{equation}

Now add some forcing,
\begin{align}
\frac{\partial \hat{u}}{\partial t} = \hat{F} +  \nu (i k 2 \pi)^{2n} \hat{u}
\end{align}
solution
\begin{equation}
\hat{u} = u_0 e^{\nu (-1)^n (k 2 \pi)^{2n} t} - (-1)^n \frac{F}{ \nu (k 2 \pi)^{2n}}
\end{equation}
Then, in steady state,
\begin{equation}
\hat{u}\hat{u}^\ast =  \frac{F^2}{ \nu^2 } (2 \pi k )^{-4n}
\end{equation}

\begin{itemize}
\item We can compute the wavenumber at which damping drops the amplitude more than 50 percent during the length of the simulation.
\item We can compute, given U, the cfl criteria, and then ask that the Reynolds number be one at the grid scale.
\end{itemize}

How does this hyperviscous $\nu$ compare to the usual $\nu_0$?
\begin{align}
\nu (k 2 \pi)^{2n} u =& \nu_0 (k 2 \pi)^{2} u \\
\nu_0 = \nu (k 2 \pi)^{2n-2}  \\
\nu_0 = \frac{1}{T} \left( \frac{\Delta}{\pi} \right)^{2}
\end{align}

\begin{align}
 \frac{U \Delta}{\nu_0} =& 1\\
\frac{(-1)^{n+1}}{U \Delta} \left( \frac{\Delta}{\pi} \right)^{2} =& T
\end{align}

For one simulation, we have that $U = 0.0365$ m/s and $\Delta=6750$ m with $n=3$. This suggests a damping time scale of $T=18000$s. The actually simulation used twice that.

The linear wave mode propagation speed seems to be the maximum velocity in these simulations. Wait. There's no surface, so that can't matter.

%%%%%%%%%%%%%%
%
\section{Decorrelation time}
%
%%%%%%%%%%%%%%

\begin{align}
R(\tau \geq 0) =& \int_0^\infty u(t)u(t+\tau) \, dt \\
=& \int_0^\infty e^{\nu (i k 2 \pi)^{2n} t} e^{\nu (i k 2 \pi)^{2n} (t + \tau) } \, dt \\
=& \frac{e^{ \nu (i k 2 \pi)^{2n} (2t + \tau)}}{2 \nu (i k 2 \pi)^{2n}} \biggr\rvert_0^\infty
\end{align}

So what is $\nu (k 2 \pi)^{2n}$?
\begin{align}
\nu (i k 2 \pi)^{2n} =&  \frac{(-1)^{n+1}}{T} \left( \frac{\Delta}{\pi} \right)^{2n}(i k 2 \pi)^{2n} \\
=& - \frac{(k 2 \Delta)^{2n}}{T} 
\end{align}
So then,
\begin{align}
R(\tau) =&- \frac{T} {2(k 2 \Delta)^{2n}} e^{ - (k 2 \Delta)^{2n}\frac{\tau}{T}} 
\end{align}
If we normalize by the total variance of the integrated velocity, then we have that,
\begin{align}
R(\tau) =& e^{ - (k 2 \Delta)^{2n}\frac{\tau}{T}} 
\end{align}
So how long does it take for each wavenumber to decay to $\epsilon=0.5$?
\begin{align}
\ln \epsilon =& - (k 2 \Delta)^{2n}\frac{\tau}{T} \\
\tau =& \frac{T \ln \epsilon}{- (k 2 \Delta)^{2n}}
\end{align}
I also want to know which wavenumbers take a certain amount of time to decay.
\begin{align}
(k 2 \Delta)^{2n} =& -\frac{T \ln \epsilon}{ \tau} \\
k = \frac{1}{2 \Delta} \left( -\frac{T \ln \epsilon}{ \tau} \right)^{\frac{1}{2n}}
\end{align}

In terms of mode number,
\begin{align}
\frac{j}{2 N \Delta} =& \frac{1}{2 \Delta} \left( -\frac{T \ln \epsilon}{ \tau} \right)^{\frac{1}{2n}} \\
j =&  N \left( -\frac{T \ln \epsilon}{ \tau} \right)^{\frac{1}{2n}}
\end{align}

%%%%%%%%%%%%%%
%
\section{2D Decorrelation time}
%
%%%%%%%%%%%%%%

In two-dimensions the damping solution is,
\begin{equation}
u = e^{ (\lambda_x+\lambda_z) t}.
\end{equation}
So,
\begin{align}
R(\tau \geq 0) =& \int_0^\infty u(t)u(t+\tau) \, dt \\
=&\int_0^\infty e^{(\lambda_x+\lambda_z)  t} e^{(\lambda_x+\lambda_z)  (t + \tau) } \, dt \\
=& \frac{e^{ (\lambda_x+\lambda_z) (2t + \tau)}}{2 (\lambda_x+\lambda_z) } \biggr\rvert_0^\infty \\
=&  \frac{e^{ (\lambda_x+\lambda_z) \tau }}{2 (\lambda_x+\lambda_z) } 
\end{align}
Normalized, this is quite simply,
\begin{align}
R(\tau \geq 0) =&  e^{ (\lambda_x+\lambda_z) \tau }
\end{align}

\end{document}
